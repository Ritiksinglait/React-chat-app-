{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ritik\\\\OneDrive\\\\Desktop\\\\Highfy\\\\react-chat\\\\src\\\\chat\\\\Chat.js\";\nimport React, { useState } from 'react';\nimport ChannelList from './ChannelList';\nimport './chat.css';\nimport MessagesPanel from './MessagesPanel';\nimport socketClient from \"socket.io-client\";\nconst SERVER = \"http://127.0.0.1:8080\";\n\nconst Chat = props => {\n  const [state, setState] = useState({\n    channels: 'null',\n    socket: \"null\",\n    channel: \"null\"\n  }); // state = {\n  //     channels: null,\n  //     socket: null,\n  //     channel: null\n  // }\n\n  socket;\n\n  componentDidMount = () => {\n    props.loadChannels();\n    props.configureSocket();\n  };\n\n  configureSocket = () => {\n    var socket = socketClient(SERVER);\n    socket.on('connection', () => {\n      if (state.channel) {\n        handleChannelSelect(state.channel.id);\n      }\n    });\n    socket.on('channel', channel => {\n      let channels = state.channels;\n      channels.forEach(c => {\n        if (c.id === channel.id) {\n          c.participants = channel.participants;\n        }\n      });\n      setState({\n        channels\n      });\n    });\n    socket.on('message', message => {\n      let channels = state.channels;\n      channels.forEach(c => {\n        if (c.id === message.channel_id) {\n          if (!c.messages) {\n            c.messages = [message];\n          } else {\n            c.messages.push(message);\n          }\n        }\n      });\n      setState({\n        channels\n      });\n    });\n    socket = socket;\n  };\n\n  loadChannels = async () => {\n    fetch('http://localhost:8080/getChannels').then(async response => {\n      let data = await response.json();\n      setState({\n        channels: data.channels\n      });\n    });\n  };\n\n  handleChannelSelect = id => {\n    let channel = state.channels.find(c => {\n      return c.id === id;\n    });\n    setState({\n      channel\n    });\n    socket.emit('channel-join', id, ack => {});\n  };\n\n  handleSendMessage = (channel_id, text) => {\n    socket.emit('send-message', {\n      channel_id,\n      text,\n      senderName: socket.id,\n      id: Date.now()\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chat-app\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ChannelList, {\n    channels: state.channels,\n    onSelectChannel: handleChannelSelect,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(MessagesPanel, {\n    onSendMessage: handleSendMessage,\n    channel: state.channel,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 17\n    }\n  }));\n};\n\nexport default Chat;","map":{"version":3,"names":["React","useState","ChannelList","MessagesPanel","socketClient","SERVER","Chat","props","state","setState","channels","socket","channel","componentDidMount","loadChannels","configureSocket","on","handleChannelSelect","id","forEach","c","participants","message","channel_id","messages","push","fetch","then","response","data","json","find","emit","ack","handleSendMessage","text","senderName","Date","now"],"sources":["C:/Users/ritik/OneDrive/Desktop/Highfy/react-chat/src/chat/Chat.js"],"sourcesContent":["import React,{useState} from 'react';\r\nimport  ChannelList  from './ChannelList';\r\nimport './chat.css';\r\nimport  MessagesPanel  from './MessagesPanel';\r\nimport socketClient from \"socket.io-client\";\r\nconst SERVER = \"http://127.0.0.1:8080\";\r\nconst Chat =(props)=> {\r\n    const [state,setState]=useState( {channels: 'null',socket: \"null\",channel: \"null\"});\r\n\r\n   \r\n\r\n    // state = {\r\n    //     channels: null,\r\n    //     socket: null,\r\n    //     channel: null\r\n    // }\r\n    socket;\r\n    \r\n    componentDidMount=()=> {\r\n        props.loadChannels();\r\n        props.configureSocket();\r\n    }\r\n\r\n    configureSocket = () => {\r\n        var socket = socketClient(SERVER);\r\n        socket.on('connection', () => {\r\n            if (state.channel) {\r\n                handleChannelSelect(state.channel.id);\r\n            }\r\n        });\r\n        socket.on('channel', channel => {\r\n            \r\n            let channels = state.channels;\r\n            channels.forEach(c => {\r\n                if (c.id === channel.id) {\r\n                    c.participants = channel.participants;\r\n                }\r\n            });\r\n            setState({ channels });\r\n        });\r\n        socket.on('message', message => {\r\n            \r\n            let channels =state.channels\r\n            channels.forEach(c => {\r\n                if (c.id === message.channel_id) {\r\n                    if (!c.messages) {\r\n                        c.messages = [message];\r\n                    } else {\r\n                        c.messages.push(message);\r\n                    }\r\n                }\r\n            });\r\n            setState({ channels });\r\n        });\r\n        socket = socket;\r\n    }\r\n\r\n    loadChannels = async () => {\r\n        fetch('http://localhost:8080/getChannels').then(async response => {\r\n            let data = await response.json();\r\n            setState({ channels: data.channels });\r\n        })\r\n    }\r\n\r\n    handleChannelSelect = id => {\r\n        let channel = state.channels.find(c => {\r\n            return c.id === id;\r\n        });\r\n        setState({ channel });\r\n        socket.emit('channel-join', id, ack => {\r\n        });\r\n    }\r\n\r\n    handleSendMessage = (channel_id, text) => {\r\n        socket.emit('send-message', { channel_id, text, senderName:socket.id, id: Date.now() });\r\n    }\r\n\r\n    \r\n\r\n        return (\r\n            <div className='chat-app'>\r\n                <ChannelList channels={state.channels} onSelectChannel={handleChannelSelect} />\r\n                <MessagesPanel onSendMessage={handleSendMessage} channel={state.channel} />\r\n            </div>\r\n        );\r\n    \r\n}\r\nexport default Chat;"],"mappings":"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"},"metadata":{},"sourceType":"module"}